---

title: Helper functions for processing data and basic transforms


keywords: fastai
sidebar: home_sidebar

summary: "Functions for getting, splitting, and labeling data, as well as generic transforms"
description: "Functions for getting, splitting, and labeling data, as well as generic transforms"
nb_path: "nbs/05_data.transforms.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05_data.transforms.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get,-split,-and-label">Get, split, and label<a class="anchor-link" href="#Get,-split,-and-label"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For most data source creation we need functions to get a list of items, split them in to train/valid sets, and label them. fastai provides functions to make each of these steps easy (especially when combined with <code>fastai.data.blocks</code>).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get">Get<a class="anchor-link" href="#Get"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we'll look at functions that <em>get</em> a list of items (generally file names).</p>
<p>We'll use <em>tiny MNIST</em> (a subset of MNIST with just two classes, <code>7</code>s and <code>3</code>s) for our examples/tests throughout this page.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
<span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/3&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_files" class="doc_header"><code>get_files</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L26" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_files</code>(<strong><code>path</code></strong>, <strong><code>extensions</code></strong>=<em><code>None</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>, <strong><code>followlinks</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Get all the files in <code>path</code> with optional <code>extensions</code>, optionally with <code>recurse</code>, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the most general way to grab a bunch of file names from disk. If you pass <code>extensions</code> (including the <code>.</code>) then returned file names are filtered by that list. Only those files directly in <code>path</code> are included, unless you pass <code>recurse</code>, in which case all child folders are also searched recursively. <code>folders</code> is an optional list of directories to limit the search to.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t3</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">t7</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">t</span>  <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">t7</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
<span class="n">t</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#709) [Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7/723.png&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7/7446.png&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7/8566.png&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7/9200.png&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7/7085.png&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7/8665.png&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7/7348.png&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7/9283.png&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7/9854.png&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7/9548.png&#39;)...]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's often useful to be able to create functions with customized behavior. <code>fastai.data</code> generally uses functions named as CamelCase verbs ending in <code>er</code> to create these functions. <a href="/data.transforms.html#FileGetter"><code>FileGetter</code></a> is a simple example of such a function creator.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FileGetter" class="doc_header"><code>FileGetter</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FileGetter</code>(<strong><code>suf</code></strong>=<em><code>''</code></em>, <strong><code>extensions</code></strong>=<em><code>None</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="/data.transforms.html#get_files"><code>get_files</code></a> partial function that searches path suffix <code>suf</code>, only in <code>folders</code>, if specified, and passes along args</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fpng</span> <span class="o">=</span> <span class="n">FileGetter</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t7</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">)))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
<span class="n">fpng_r</span> <span class="o">=</span> <span class="n">FileGetter</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng_r</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_image_files" class="doc_header"><code>get_image_files</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L55" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_image_files</code>(<strong><code>path</code></strong>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get image files in <code>path</code> recursively, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is simply <a href="/data.transforms.html#get_files"><code>get_files</code></a> called with a list of standard image extensions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ImageGetter" class="doc_header"><code>ImageGetter</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L60" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ImageGetter</code>(<strong><code>suf</code></strong>=<em><code>''</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="/data.transforms.html#get_image_files"><code>get_image_files</code></a> partial function that searches path suffix <code>suf</code> and passes along <code>kwargs</code>, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Same as <a href="/data.transforms.html#FileGetter"><code>FileGetter</code></a>, but for image extensions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)),</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">ImageGetter</span><span class="p">(</span>   <span class="s1">&#39;train&#39;</span><span class="p">,</span>                    <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)(</span><span class="n">path</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_text_files" class="doc_header"><code>get_text_files</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L66" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_text_files</code>(<strong><code>path</code></strong>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get text files in <code>path</code> recursively, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ItemGetter" class="doc_header"><code>class</code> <code>ItemGetter</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L71" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ItemGetter</code>(<strong><code>i</code></strong>) :: <a href="https://fastcore.fast.ai/transform#ItemTransform"><code>ItemTransform</code></a></p>
</blockquote>
<p>Creates a proper transform that applies <code>itemgetter(i)</code> (even on a tuple)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">ItemGetter</span><span class="p">(</span><span class="mi">1</span><span class="p">)((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>  <span class="mi">2</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ItemGetter</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ItemGetter</span><span class="p">(</span><span class="mi">1</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span>  <span class="mi">2</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ItemGetter</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])),</span>  <span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AttrGetter" class="doc_header"><code>class</code> <code>AttrGetter</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L78" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AttrGetter</code>(<strong><code>nm</code></strong>, <strong><code>default</code></strong>=<em><code>None</code></em>) :: <a href="https://fastcore.fast.ai/transform#ItemTransform"><code>ItemTransform</code></a></p>
</blockquote>
<p>Creates a proper transform that applies <code>attrgetter(nm)</code> (even on a tuple)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">AttrGetter</span><span class="p">(</span><span class="s1">&#39;shape&#39;</span><span class="p">)(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])),</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">AttrGetter</span><span class="p">(</span><span class="s1">&#39;shape&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Split">Split<a class="anchor-link" href="#Split"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next set of functions are used to <em>split</em> data into training and validation sets. The functions return two lists - a list of indices or masks for each of training and validation sets.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RandomSplitter" class="doc_header"><code>RandomSplitter</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L85" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RandomSplitter</code>(<strong><code>valid_pct</code></strong>=<em><code>0.2</code></em>, <strong><code>seed</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create function that splits <code>items</code> between train/val with <code>valid_pct</code> randomly.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">trn</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">o</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">trn</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
<span class="c1"># test random seed consistency</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Use scikit-learn train_test_split. This allow to <em>split</em> items in a stratified fashion (uniformely according to the ‘labels‘ distribution)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="TrainTestSplitter" class="doc_header"><code>TrainTestSplitter</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L95" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>TrainTestSplitter</code>(<strong><code>test_size</code></strong>=<em><code>0.2</code></em>, <strong><code>random_state</code></strong>=<em><code>None</code></em>, <strong><code>stratify</code></strong>=<em><code>None</code></em>, <strong><code>train_size</code></strong>=<em><code>None</code></em>, <strong><code>shuffle</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Split <code>items</code> into random train and test subsets using sklearn train_test_split utility.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>
<span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">TrainTestSplitter</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">trn</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">o</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">trn</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>

<span class="c1"># test random seed consistency</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trn</span><span class="p">)</span>

<span class="c1"># test labels distribution consistency</span>
<span class="c1"># there should be test_size % of zeroes and ones respectively in the validation set</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">([</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">val</span> <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">])</span> <span class="o">/</span> <span class="mi">20</span><span class="p">,</span> <span class="n">test_size</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">([</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">val</span> <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">])</span> <span class="o">/</span> <span class="mi">10</span><span class="p">,</span> <span class="n">test_size</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="IndexSplitter" class="doc_header"><code>IndexSplitter</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L103" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>IndexSplitter</code>(<strong><code>valid_idx</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> so that <code>val_idx</code> are in the validation set and the others in the training set</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">IndexSplitter</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="GrandparentSplitter" class="doc_header"><code>GrandparentSplitter</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L116" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>GrandparentSplitter</code>(<strong><code>train_name</code></strong>=<em><code>'train'</code></em>, <strong><code>valid_name</code></strong>=<em><code>'valid'</code></em>)</p>
</blockquote>
<p>Split <code>items</code> from the grand parent folder names (<code>train_name</code> and <code>valid_name</code>).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/3/9932.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/7/7189.png&#39;</span><span class="p">,</span> 
          <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/7/7320.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/7/9833.png&#39;</span><span class="p">,</span>  
          <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/3/7666.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/3/925.png&#39;</span><span class="p">,</span>
          <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/7/724.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/3/93055.png&#39;</span><span class="p">]</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">()</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">fnames</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fnames2</span> <span class="o">=</span> <span class="n">fnames</span> <span class="o">+</span> <span class="p">[</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;test/3/4256.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;test/7/2345.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/7/6467.png&#39;</span><span class="p">]</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">(</span><span class="n">train_name</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;valid&#39;</span><span class="p">),</span> <span class="n">valid_name</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">fnames2</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FuncSplitter" class="doc_header"><code>FuncSplitter</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L123" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FuncSplitter</code>(<strong><code>func</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> by result of <code>func</code> (<code>True</code> for validation, <code>False</code> for training set).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splitter</span> <span class="o">=</span> <span class="n">FuncSplitter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;valid&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">fnames</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MaskSplitter" class="doc_header"><code>MaskSplitter</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L131" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MaskSplitter</code>(<strong><code>mask</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> depending on the value of <code>mask</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">MaskSplitter</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">),[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FileSplitter" class="doc_header"><code>FileSplitter</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L137" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FileSplitter</code>(<strong><code>fname</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> by providing file <code>fname</code> (contains names of valid items separated by newline).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">d</span><span class="p">:</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="s1">&#39;valid.txt&#39;</span>
    <span class="n">fname</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">Path</span><span class="p">(</span><span class="n">fnames</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]))</span>
    <span class="n">splitter</span> <span class="o">=</span> <span class="n">FileSplitter</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">fnames</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ColSplitter" class="doc_header"><code>ColSplitter</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L145" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ColSplitter</code>(<strong><code>col</code></strong>=<em><code>'is_valid'</code></em>)</p>
</blockquote>
<p>Split <code>items</code> (supposed to be a dataframe) by value in <code>col</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">]})</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">ColSplitter</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splits</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="c1">#Works with strings or index</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">ColSplitter</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splits</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RandomSubsetSplitter" class="doc_header"><code>RandomSubsetSplitter</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L154" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RandomSubsetSplitter</code>(<strong><code>train_sz</code></strong>, <strong><code>valid_sz</code></strong>, <strong><code>seed</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Take randoms subsets of <code>splits</code> with <code>train_sz</code> and <code>valid_sz</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">valid_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">RandomSubsetSplitter</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)(</span><span class="n">items</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Label">Label<a class="anchor-link" href="#Label"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The final set of functions is used to <em>label</em> a single item of data.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parent_label" class="doc_header"><code>parent_label</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L168" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parent_label</code>(<strong><code>o</code></strong>)</p>
</blockquote>
<p>Label <code>item</code> with the parent folder name.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that <a href="/data.transforms.html#parent_label"><code>parent_label</code></a> doesn't have anything customize, so it doesn't return a function - you can just use it directly.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">fnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="s2">&quot;fastai_dev/dev/data/mnist_tiny/train/3/9932.png&quot;</span><span class="p">),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">parent_label</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fnames</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;3&#39;, &#39;7&#39;, &#39;7&#39;, &#39;7&#39;, &#39;3&#39;, &#39;3&#39;, &#39;7&#39;, &#39;3&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RegexLabeller" class="doc_header"><code>class</code> <code>RegexLabeller</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L173" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RegexLabeller</code>(<strong><code>pat</code></strong>, <strong><code>match</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Label <code>item</code> with regex <code>pat</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/data.transforms.html#RegexLabeller"><code>RegexLabeller</code></a> is a very flexible function since it handles any regex search of the stringified item. Pass <code>match=True</code> to use <code>re.match</code> (i.e. check only start of string), or <code>re.search</code> otherwise (default).</p>
<p>For instance, here's an example the replicates the previous <a href="/data.transforms.html#parent_label"><code>parent_label</code></a> results.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">RegexLabeller</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s1">(\d)</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">fnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fnames</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;3&#39;, &#39;7&#39;, &#39;7&#39;, &#39;7&#39;, &#39;3&#39;, &#39;3&#39;, &#39;7&#39;, &#39;3&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">RegexLabeller</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\d*)&#39;</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">fnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="s1">&#39;9932&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ColReader" class="doc_header"><code>class</code> <code>ColReader</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L185" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ColReader</code>(<strong><code>cols</code></strong>, <strong><code>pref</code></strong>=<em><code>''</code></em>, <strong><code>suff</code></strong>=<em><code>''</code></em>, <strong><code>label_delim</code></strong>=<em><code>None</code></em>) :: <a href="https://fastcore.fast.ai/transform#DisplayedTransform"><code>DisplayedTransform</code></a></p>
</blockquote>
<p>Read <code>cols</code> in <code>row</code> with potential <code>pref</code> and <code>suff</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>cols</code> can be a list of column names or a list of indices (or a mix of both). If <code>label_delim</code> is passed, the result is split using it.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;a b c d&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;1 2&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;1 2 3&#39;</span><span class="p">]})</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pref</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">suff</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="s1">&#39;0a1 0b1 0c1 0d1&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label_delim</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="p">[[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]])</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a1&#39;</span><span class="p">],</span> <span class="n">pref</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">suff</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="s1">&#39;0a1&#39;</span><span class="p">,</span> <span class="s1">&#39;0a1&#39;</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="s1">&#39;0b1&#39;</span><span class="p">,</span> <span class="s1">&#39;0b1&#39;</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="s1">&#39;0c1&#39;</span><span class="p">,</span> <span class="s1">&#39;0c1&#39;</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="s1">&#39;0d1&#39;</span><span class="p">,</span> <span class="s1">&#39;0d1&#39;</span><span class="p">)])</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)]})</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])],</span> <span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CategoryMap" class="doc_header"><code>class</code> <code>CategoryMap</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L204" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CategoryMap</code>(<strong><code>col</code></strong>, <strong><code>sort</code></strong>=<em><code>True</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>, <strong><code>strict</code></strong>=<em><code>False</code></em>) :: <a href="https://fastcore.fast.ai/foundation#CollBase"><code>CollBase</code></a></p>
</blockquote>
<p>Collection of categories with the reverse mapping in <code>o2i</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">map_objs</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">map_ids</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">test_fail</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">[</span><span class="s1">&#39;unseen label&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">add_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#na#&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;#na#&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">col</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">],</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">col</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">],</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Categorize" class="doc_header"><code>class</code> <code>Categorize</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L230" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Categorize</code>(<strong><code>vocab</code></strong>=<em><code>None</code></em>, <strong><code>sort</code></strong>=<em><code>True</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <a href="https://fastcore.fast.ai/transform#DisplayedTransform"><code>DisplayedTransform</code></a></p>
</blockquote>
<p>Reversible transform of category string to <code>vocab</code> id</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Category" class="doc_header"><code>class</code> <code>Category</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L245" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Category</code>() :: <code>str</code></p>
</blockquote>
<p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">Categorize</span><span class="p">()</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;dog&#39;</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;cat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">Categorize</span><span class="p">(</span><span class="n">add_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#na#&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;dog&#39;</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;cat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">Categorize</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#na#&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="s1">&#39;dog&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;cat&#39;</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;cat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiCategorize" class="doc_header"><code>class</code> <code>MultiCategorize</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L248" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiCategorize</code>(<strong><code>vocab</code></strong>=<em><code>None</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <a href="/data.transforms.html#Categorize"><code>Categorize</code></a></p>
</blockquote>
<p>Reversible transform of multi-category strings to <code>vocab</code> id</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiCategory" class="doc_header"><code>class</code> <code>MultiCategory</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L264" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiCategory</code>(<strong><code>items</code></strong>=<em><code>None</code></em>, <strong>*<code>rest</code></strong>, <strong><code>use_list</code></strong>=<em><code>False</code></em>, <strong><code>match</code></strong>=<em><code>None</code></em>) :: <a href="https://fastcore.fast.ai/foundation#L"><code>L</code></a></p>
</blockquote>
<p>Behaves like a list of <code>items</code> but can also index with list of indices or masks</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">MultiCategorize</span><span class="p">()</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[]],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">TensorMultiCategory</span><span class="p">([]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">([]),</span> <span class="n">tensor</span><span class="p">([]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;a;c&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="OneHotEncode" class="doc_header"><code>class</code> <code>OneHotEncode</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L269" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>OneHotEncode</code>(<strong><code>c</code></strong>=<em><code>None</code></em>) :: <a href="https://fastcore.fast.ai/transform#DisplayedTransform"><code>DisplayedTransform</code></a></p>
</blockquote>
<p>One-hot encodes targets</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Works in conjunction with <code>MultiCategorize</code> or on its own if you have one-hot encoded targets (pass a <code>vocab</code> for decoding and <code>do_encode=False</code> in this case)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_tfm</span> <span class="o">=</span> <span class="n">OneHotEncode</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tds</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[]],</span> <span class="p">[[</span><span class="n">MultiCategorize</span><span class="p">(),</span> <span class="n">OneHotEncode</span><span class="p">()]])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="n">tensor</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])]),</span> <span class="p">[[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">]])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="n">TensorMultiCategory</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;a;c&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EncodedMultiCategorize" class="doc_header"><code>class</code> <code>EncodedMultiCategorize</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L283" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EncodedMultiCategorize</code>(<strong><code>vocab</code></strong>) :: <a href="/data.transforms.html#Categorize"><code>Categorize</code></a></p>
</blockquote>
<p>Transform of one-hot encoded multi-category that decodes with <code>vocab</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_tfm</span> <span class="o">=</span> <span class="n">EncodedMultiCategorize</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])),</span> <span class="n">TensorMultiCategory</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])),</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_tfm</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>EncodedMultiCategorize -- {&#39;vocab&#39;: (#3) [&#39;a&#39;,&#39;b&#39;,&#39;c&#39;], &#39;add_na&#39;: False}:
encodes: (object,object) -&gt; encodes
(object,object) -&gt; encodes
decodes: (object,object) -&gt; decodes
(object,object) -&gt; decodes</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RegressionSetup" class="doc_header"><code>class</code> <code>RegressionSetup</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L293" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RegressionSetup</code>(<strong><code>c</code></strong>=<em><code>None</code></em>) :: <a href="https://fastcore.fast.ai/transform#DisplayedTransform"><code>DisplayedTransform</code></a></p>
</blockquote>
<p>Transform that floatifies targets</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_tfm</span> <span class="o">=</span> <span class="n">RegressionSetup</span><span class="p">()</span>
<span class="n">dsets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">RegressionSetup</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">dsets</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq_type</span><span class="p">(</span><span class="n">dsets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">),))</span>

<span class="n">dsets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span> <span class="n">RegressionSetup</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">dsets</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">test_eq_type</span><span class="p">(</span><span class="n">dsets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]),))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_c" class="doc_header"><code>get_c</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L307" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_c</code>(<strong><code>dls</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="End-to-end-dataset-example-with-MNIST">End-to-end dataset example with MNIST<a class="anchor-link" href="#End-to-end-dataset-example-with-MNIST"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's show how to use those functions to grab the mnist dataset in a <a href="/data.core.html#Datasets"><code>Datasets</code></a>. First we grab all the images.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then we split between train and validation depending on the folder.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splitter</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">()</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span><span class="n">valid</span> <span class="o">=</span> <span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">)</span>
<span class="n">train</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span><span class="n">valid</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#3) [Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7/723.png&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7/7446.png&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/train/7/8566.png&#39;)],
 (#3) [Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/valid/7/946.png&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/valid/7/9608.png&#39;),Path(&#39;/home/jhoward/.fastai/data/mnist_tiny/valid/7/825.png&#39;)])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our inputs are images that we open and convert to tensors, our targets are labeled depending on the parent directory and are categories.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">open_img</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span><span class="n">Path</span><span class="p">):</span> <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">img2tensor</span><span class="p">(</span><span class="n">im</span><span class="p">:</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span> <span class="k">return</span> <span class="n">TensorImage</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)[</span><span class="kc">None</span><span class="p">])</span>

<span class="n">tfms</span> <span class="o">=</span> <span class="p">[[</span><span class="n">open_img</span><span class="p">,</span> <span class="n">img2tensor</span><span class="p">],</span>
        <span class="p">[</span><span class="n">parent_label</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">()]]</span>
<span class="n">train_ds</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">tfms</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">train_ds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">xd</span><span class="p">,</span><span class="n">yd</span> <span class="o">=</span> <span class="n">decode_at</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="n">yd</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span><span class="n">xd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">show_at</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;7&#39;</span><span class="p">)</span>
<span class="n">test_fig_exists</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ToTensor" class="doc_header"><code>class</code> <code>ToTensor</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L316" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ToTensor</code>(<strong><code>enc</code></strong>=<em><code>None</code></em>, <strong><code>dec</code></strong>=<em><code>None</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>order</code></strong>=<em><code>None</code></em>) :: <a href="https://fastcore.fast.ai/transform#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Convert item to appropriate tensor class</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="IntToFloatTensor" class="doc_header"><code>class</code> <code>IntToFloatTensor</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L321" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>IntToFloatTensor</code>(<strong><code>div</code></strong>=<em><code>255.0</code></em>, <strong><code>div_mask</code></strong>=<em><code>1</code></em>) :: <a href="https://fastcore.fast.ai/transform#DisplayedTransform"><code>DisplayedTransform</code></a></p>
</blockquote>
<p>Transform image to float tensor, optionally dividing by 255 (e.g. for images).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">TensorImage</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">tensor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">long</span><span class="p">(),</span><span class="n">TensorMask</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">tfm</span> <span class="o">=</span> <span class="n">IntToFloatTensor</span><span class="p">()</span>
<span class="n">ft</span> <span class="o">=</span> <span class="n">tfm</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">TensorImage</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">TensorMask</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="broadcast_vec" class="doc_header"><code>broadcast_vec</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L331" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>broadcast_vec</code>(<strong><code>dim</code></strong>, <strong><code>ndim</code></strong>, <strong>*<code>t</code></strong>, <strong><code>cuda</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Make a vector broadcastable over <code>dim</code> (out of <code>ndim</code> total) by prepending and appending unit axes</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Normalize" class="doc_header"><code>class</code> <code>Normalize</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/transforms.py#L340" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Normalize</code>(<strong><code>mean</code></strong>=<em><code>None</code></em>, <strong><code>std</code></strong>=<em><code>None</code></em>, <strong><code>axes</code></strong>=<em><code>(0, 2, 3)</code></em>) :: <a href="https://fastcore.fast.ai/transform#DisplayedTransform"><code>DisplayedTransform</code></a></p>
</blockquote>
<p>Normalize/denorm batch of <a href="/torch_core.html#TensorImage"><code>TensorImage</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mean</span><span class="p">,</span><span class="n">std</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
<span class="n">mean</span><span class="p">,</span><span class="n">std</span> <span class="o">=</span> <span class="n">broadcast_vec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
<span class="n">batch_tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">IntToFloatTensor</span><span class="p">(),</span> <span class="n">Normalize</span><span class="o">.</span><span class="n">from_stats</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="n">std</span><span class="p">)]</span>
<span class="n">tdl</span> <span class="o">=</span> <span class="n">TfmdDL</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">after_batch</span><span class="o">=</span><span class="n">batch_tfms</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">default_device</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span>  <span class="o">=</span> <span class="n">tdl</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">xd</span><span class="p">,</span><span class="n">yd</span> <span class="o">=</span> <span class="n">tdl</span><span class="o">.</span><span class="n">decode</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>

<span class="n">test_eq</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span> <span class="s1">&#39;torch.cuda.FloatTensor&#39;</span> <span class="k">if</span> <span class="n">default_device</span><span class="p">()</span><span class="o">.</span><span class="n">type</span><span class="o">==</span><span class="s1">&#39;cuda&#39;</span> <span class="k">else</span> <span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">xd</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span> <span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">TensorImage</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">TensorCategory</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">&lt;</span><span class="mf">0.0</span>
<span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">&gt;</span><span class="mf">0.5</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">xd</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">/</span><span class="mf">255.</span><span class="o">&lt;</span><span class="mi">1</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">xd</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="mf">255.</span><span class="o">&lt;</span><span class="mf">0.5</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.core</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tdl</span><span class="o">.</span><span class="n">show_batch</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

